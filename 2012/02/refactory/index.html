<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:og="http://ogp.me/ns#"
      xmlns:fb="https://www.facebook.com/2008/fbml">
<head>
    <title>再读《重构》</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Open Graph tags -->

            <meta property="og:type" content="article"/>
            <meta property="og:title" content="再读《重构》"/>
            <meta property="og:url" content="/2012/02/refactory/"/>
            <meta property="og:description" content="Martin Fowler 的《重构- 改善既有代码的设计》这本书，是我大学老师推荐给我的。 当时我在撰写代码过程中，发现当代码量到某个数量级时候（1000+行）， 就会逐渐失去对代码的控制能力。昆哥推荐了两本书《UML和模式应用》和《重构》这本书。 这本书是2年前购买的，可惜以我当时的代码感知和撰写能力，看起来颇为吃力。 半途就看得云里雾里而中断了。最近我又重新拾起这本书， 将书中所写的境况与我这两年多来遇到的问题相互印证，才感受到这本经典的力量。 Martin 其人： ThoughtWorks的首席科学家，当今世界软件开发领域最具影响力的五位大师之一。 他在UML推广普及、领域建模、企业应用开发和敏捷方法等方面建树卓著，被称为软件开发的教父。 大学时候有段时间我对 Martin 的敏捷非常痴迷。现在对技术的选择没以前那么冲动了， 但是毫不妨碍我对 Martin 的敬仰之情 ..."/>

    <!-- Bootstrap -->
        <link rel="stylesheet" href="/theme/css/bootstrap.min.css" type="text/css"/>
    <link href="/theme/css/font-awesome.min.css" rel="stylesheet">
    <link href="/theme/css/pygments.css" rel="stylesheet">
    <link rel="stylesheet" href="/theme/css/style.css" type="text/css"/>
    <!-- JavaScript plugins (requires jQuery) -->
    <script src="http://code.jquery.com/jquery.js"></script>


    <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-8822123-3']);
        _gaq.push(['_trackPageview']);

        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();

    </script>
</head>
<body>
<nav class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="/" class="navbar-brand">Log4D</a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
                    <li><a href="/tags/">Tags</a></li>
                    <li><a href="/links/">Links</a></li>
                    <li><a href="/about/">About</a></li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li><a href="/archives/"><i class="icon-th-list"></i>Archives</a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</nav>
<!-- /.navbar -->
<div class="container">
    <div class="row">
        <div class="col-lg-9">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="/2012/02/refactory/"
                       rel="bookmark"
                       title="Permalink to 再读《重构》">
                        再读《重构》
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="icon-calendar"></i>2012-02-05
    </span>



<span class="label label-default">Tags</span>
	<a href="/tag/du-shu-bi-ji/">读书笔记</a>
</footer><!-- /.post-info -->                    </div>
                </div>
                <p>Martin Fowler 的《<a href="http://book.douban.com/subject/1229923/">重构-
改善既有代码的设计</a>》这本书，是我大学老师推荐给我的。
当时我在撰写代码过程中，发现当代码量到某个数量级时候（1000+行）， 就会逐渐失去对代码的控制能力。昆哥推荐了两本书《<a href="http://
book.douban.com/subject/1792387/">UML和模式应用</a>》和《重构》这本书。</p>
<p><img alt="refactory" src="http://img1.douban.com/mpic/s1669771.jpg" /></p>
<p>这本书是2年前购买的，可惜以我当时的代码感知和撰写能力，看起来颇为吃力。 半途就看得云里雾里而中断了。最近我又重新拾起这本书，
将书中所写的境况与我这两年多来遇到的问题相互印证，才感受到这本经典的力量。</p>
<p>Martin 其人：</p>
<div class="highlight"><pre><span class="n">ThoughtWorks</span><span class="err">的首席科学家，当今世界软件开发领域最具影响力的五位大师之一。</span>
<span class="err">他在</span><span class="n">UML</span><span class="err">推广普及、领域建模、企业应用开发和敏捷方法等方面建树卓著，被称为软件开发的教父。</span>
</pre></div>


<p>大学时候有段时间我对 Martin 的敏捷非常痴迷。现在对技术的选择没以前那么冲动了， 但是毫不妨碍我对 Martin 的敬仰之情。</p>
<h2>1. 重构原则</h2>
<h3>1.1. 重构的定义</h3>
<div class="highlight"><pre><span class="err">对软件内部结构的一种调整，目的是在不改变</span><span class="s">&quot;软件之可察行为&quot;</span><span class="err">前提下，提高其可理解性，降低其修改成本。</span>
</pre></div>


<p>重构就是在代码写好之后改进它的设计。</p>
<ul>
<li>重构和添加新功能并不冲突，但是当开发者身份在两者之间切换时候，不能混淆在一起。</li>
</ul>
<h3>1.2. 重构的意义</h3>
<ul>
<li>优秀设计的根本是：消除重复部分！（DRY = Don't repeat yourself）</li>
<li>重构让代码更清晰，更容易理解</li>
<li>清晰的代码可以更方便的找到bug，重构可以写出更强健的代码</li>
<li>良好的设计可以在长远时间上提高开发速度</li>
</ul>
<h3>1.3. 重构的时间</h3>
<ul>
<li>随时进行重构（在我看来，重构更是一种开发的习惯）</li>
<li>事不过三，代码重复不要超过三次（否则就要"抽"出来）</li>
<li>添加功能时候并一一重构（个人理解是，添加新功能之前，分析并重构，从而更方便添加新功能）</li>
<li>修补错误时</li>
<li>code review时</li>
</ul>
<h3>1.4. 重构和开发进度</h3>
<p>重构的意义之一也是提高开发进度。杀手锏是"不要告诉经理"。</p>
<h3>1.5. 重构的难题</h3>
<ul>
<li>数据层（数据模型）的变更压力</li>
<li>修改接口</li>
<li>那些难以通过重构改变的设计改动</li>
<li>代码不能运行</li>
<li>项目期限压力 dead line</li>
</ul>
<h3>1.6. 重构与设计</h3>
<ul>
<li>编程不是机械的开发，（软件开发是艺术行为！）</li>
<li>设计和重构的平衡（预先设计的难度和重构灵活性的平衡）</li>
</ul>
<h3>1.7. 重构与性能</h3>
<ul>
<li>重构确实会在短期内降低代码执行效率，但优化阶段是可以调整的，而且调整会更容易。</li>
<li>提前优化是万恶之源</li>
</ul>
<h3>1.8. 那些Bad Smell</h3>
<ul>
<li>重复的代码（这才是真正万恶之源，鄙视一切Ctrl+C/P）</li>
<li>过长函数，会导致责任不明确/难以切割/难以理解等一系列问题</li>
<li>过大类，职责不明确，垃圾滋生地</li>
<li>过长参数列（面向对象不是说说而已）</li>
<li>发散式变化，一个类会响应多种需求而被修改</li>
<li>散弹式修改（其实就是没有封装变化处，由于一个需求，多处需要被修改）</li>
<li>依赖情节（一个类对其他类过多的依赖）</li>
<li>数据泥团（如果数据有意义，就将结构数据变成对象）</li>
<li>type code，使用Class替代</li>
<li>switch，少用，考虑多态</li>
<li>过多平行的类，使用类继承并联起来</li>
<li>冗余类，去除它</li>
<li>夸夸其谈的未来性（Matin的文字，侯俊杰的翻译真是…出彩…）</li>
<li>临时值域，封装它</li>
<li>过度耦合的消息链，使用真正需要的函数和对象，而不要依赖于消息链</li>
<li>过度的deleate</li>
<li>过度使用其他类private值域</li>
<li>重复作用的类</li>
<li>不完美的类库，（类库老了，使用者也没办法阿）</li>
<li>纯数据类（类需要行为）</li>
<li>不纯粹的继承（拒绝父类的接口的类）</li>
<li>过多注释，注释多了，就说明代码不清楚了</li>
</ul>
<h3>1.9. 从测试开始</h3>
<p>无测试，无重构，只依赖手工测试，重构时候人会崩溃的。</p>
<ul>
<li>重构的保真就是自动化测试（如果真的要无聊的手工测试，我也不反对）</li>
<li>单元测试</li>
<li>功能测试</li>
</ul>
<h3>1.10. Kent Back说</h3>
<div class="highlight"><pre><span class="err">如果我纯粹为今天工作，明天我将完全无法工作。</span>
</pre></div>


<p>间接层的价值：</p>
<ul>
<li>允许逻辑共享  </li>
<li>分开解释"意图"和"实现"  </li>
<li>将变化加以隔离  </li>
<li>将条件逻辑加以编码</li>
</ul>
<p>计算机科学是这样一门学科：它相信所有问题都可以通过一个间接层来解决。 --Dennis DeBruler</p>
<p>我相信，撰写代码时候不仅仅考虑当下功能，要考虑到有可能出现的情况， 在可能的平衡下面，为将来的扩展做好准备。（也许不仅仅是自己的明天，
还要考虑团队成员的今天工作内容）</p>
<h2>2. 重构名录</h2>
<h3>2.1. 重新组织函数</h3>
<p>Extract Method（提炼函数）</p>
<div class="highlight"><pre><span class="err">将一段独立的，不依赖上下文的代码组织并独立出来。</span>
</pre></div>


<p>Inline Method（将函数内联化）</p>
<div class="highlight"><pre><span class="err">当函数内部代码简短而容易理解时候，去除这个非必要的间接层。</span>
</pre></div>


<p>Inline Temp（将临时变量内联化）</p>
<div class="highlight"><pre><span class="err">去除只被赋值一次的临时变量。（当有意义时候，应该保留）</span>
</pre></div>


<p>Replace Temp with Query（以查询取代临时变量）</p>
<div class="highlight"><pre><span class="err">将临时变量提取到一个独立函数，并将原来变量引用替换为函数调用。</span> <span class="err">（我还是担心性能的问题，另外将临时变量限定在一个段落</span><span class="n">p</span><span class="err">中，可以避免额外的引用）</span>
</pre></div>


<p>Introduce Explainning Variable（引入解释性变量）</p>
<div class="highlight"><pre><span class="err">将复杂表达式的结果放入临时变量，并用变量名来解释表达式用途。</span> <span class="err">（自注释代码的表现）</span>
</pre></div>


<p>Split Temporary Variable（剖析临时变量）</p>
<div class="highlight"><pre><span class="err">除了循环变量和临时集合变量，临时变量赋值不能超过一次。</span>
</pre></div>


<p>Remove Assignments to Parameters（移除对参数的赋值动作）</p>
<div class="highlight"><pre><span class="err">不对函数参数进行赋值动作，如果要赋值，创建一个新的临时变量。</span>
</pre></div>


<p>Replace Method with Method Object（以函数对象取代函数）</p>
<div class="highlight"><pre><span class="err">把函数变成对象，再把临时变量变成对象值域。该方法在分解函数时候常用。</span> <span class="err">（</span><span class="n">Martin</span> <span class="err">对小型函数特别迷恋，我认为这个方法更应该用在有逻辑意义的方法上面）</span>
</pre></div>


<p>Substitute Algorithm（替换算法）</p>
<div class="highlight"><pre><span class="err">用更清晰的算法。</span> <span class="err">（码农都知道）</span>
</pre></div>


<h3>2.2. 在对象之间搬移特性</h3>
<p>（面向对象编程原则之一就是职责归属，搬移其实也就意味着职责重新规划）</p>
<p>Move Method（搬移函数）</p>
<div class="highlight"><pre><span class="err">将函数移动到被最多次调用的类里面去。</span> <span class="err">（往往在逻辑意义上，这个函数就应该归属于这个类）</span>
</pre></div>


<p>Move Field（搬移值域）</p>
<div class="highlight"><pre><span class="err">将值域移动到被最多次调用的类里面去。</span>
</pre></div>


<p>Extract Class（提炼类）</p>
<div class="highlight"><pre><span class="err">将开发过程中逐渐变得臃肿的类拆分成数个类，形成清楚的抽象，明确的职责。</span>
</pre></div>


<p>Inline Class（将类内联化）</p>
<div class="highlight"><pre><span class="err">将不再担任足够职责的类搬到另外一个类中，并移除这个原始类。</span>
</pre></div>


<p>Hide Delegate（隐藏委托关系）</p>
<div class="highlight"><pre><span class="err">将直接调用变成间接，在中间添加一层，从而从容面对变更，隔离变化。</span> <span class="err">（</span><span class="s">&quot;哪里变化，封装哪里&quot;</span><span class="err">这是设计模式的一个经典原则）</span>
</pre></div>


<p>Remove Middle Man（移除中间人）</p>
<div class="highlight"><pre><span class="err">和</span><span class="n">Hide</span> <span class="n">Delegate</span><span class="err">相反，移除做了过多简单委托的类。</span> <span class="err">（应该</span><span class="n">Hide</span> <span class="n">Delegate</span><span class="err">需要加入成本，多维护一层，这需要控制一种平衡）</span>
</pre></div>


<p>Introduce Foreign Method（引入外加函数）</p>
<div class="highlight"><pre><span class="err">当类无法进行修改时候，使用静态函数接受这种类型的类实例，</span>
</pre></div>


<p>Introduce Local Extenstion（引入本地扩展）</p>
<div class="highlight"><pre><span class="err">使用子类继承</span><span class="o">/</span><span class="n">wrapper</span><span class="err">类来实现额外的函数。</span>
</pre></div>


<h3>2.3. 重新组织数据</h3>
<p>Self Encapsulate Field（自封装值域）</p>
<div class="highlight"><pre><span class="err">使用</span><span class="n">getter</span><span class="o">/</span><span class="n">setter</span><span class="err">。</span> <span class="err">（个人觉得这样很繁琐，</span><span class="p">.</span><span class="n">net</span><span class="err">中的属性方式处理的不错）</span>
</pre></div>


<p>Replace Date Value with Object （以对象取代数据值）</p>
<div class="highlight"><pre><span class="err">当数据项有额外的数据和行为时候，将它变成一个类</span>
</pre></div>


<p>Change Value to Reference（将实值对象改为引用对象）</p>
<div class="highlight"><pre><span class="err">有一些类型，比如日期、星期，不需要保存太多副本。</span>
</pre></div>


<p>Change Reference to Value（将引用对象改为实值对象）</p>
<div class="highlight"><pre><span class="err">和楼上相反的情况，引用会带来复杂的内存分配，在分布式系统中，实值对象特别有用。</span>
</pre></div>


<p>Replace Array with Object（以对象取代数组）</p>
<div class="highlight"><pre><span class="err">不应该将不同的元素存放到数组中，应该使用值域。</span>
</pre></div>


<p>Duplicate Observed Data（复制被监视数据）</p>
<div class="highlight"><pre><span class="err">通过观察者模式，将业务数据和</span><span class="n">GUI</span><span class="err">数据进行同步控制</span>
</pre></div>


<p>Change Unidirectional Association to Bidirectional（将单向关联改为双向）</p>
<div class="highlight"><pre><span class="err">使用双向连接，从而能让两个类能互相使用对方特性。</span>
</pre></div>


<p>Change Bidirectional Assicuation to Unidirectional（将双向关联改为单向）</p>
<div class="highlight"><pre><span class="err">当一个类不再需要另外一个类特性时候作修改。</span>
</pre></div>


<p>Replace Magic Number with Symbolic Constant（以符号常量/字面常量取代魔法数）</p>
<div class="highlight"><pre><span class="err">使用有意义的名称，比如</span><span class="n">pi</span><span class="p">,</span><span class="n">gravity</span><span class="err">。</span>
</pre></div>


<p>Encapsulate Field（封装值域）</p>
<div class="highlight"><pre><span class="err">使用</span><span class="n">getter</span><span class="o">/</span><span class="n">setter</span><span class="err">。</span>
</pre></div>


<p>Encapsulate Collection（封装集群）</p>
<div class="highlight"><pre><span class="err">避免直接修改容器对象，而是封装出类方法来修改。将变化控制在既有方法内。</span>
</pre></div>


<p>Replace Record with Data Class（以数据类取代记录）</p>
<div class="highlight"><pre><span class="err">将传统编程中的结构体转换为数据类。</span>
</pre></div>


<p>Replace Type Code with Class（以类别取代型别码）</p>
<div class="highlight"><pre><span class="err">使用类型集合类来替换型别码。</span>
</pre></div>


<p>Replace Type Code with Subclass（以子类取代型别码）</p>
<div class="highlight"><pre><span class="err">使用多态来替换型别码，发挥面向对象编程的优势。</span> <span class="err">（小心处理</span><span class="n">ORM</span><span class="err">映射）</span>
</pre></div>


<p>Replace Type Code with State/Strategy（以State/Strategy取代型别码）</p>
<div class="highlight"><pre><span class="err">使用</span><span class="n">State</span><span class="o">/</span><span class="n">Strategy</span><span class="err">模式来因对</span><span class="n">type</span> <span class="n">code</span><span class="err">会发生变化的情况。</span> <span class="err">将状态类作为父类，再进行继承。</span>
</pre></div>


<p>Replace Subclass with Fields（以值域取代子类）</p>
<div class="highlight"><pre><span class="err">当子类的差异仅仅体现在返回常量数据的函数上时候，进行这样的替换。</span>
</pre></div>


<h3>2.4. 简化条件表达式</h3>
<p>简化的核心思想，是将过程式的if/else替换为面向对象的多态。</p>
<p>Decompose Conditional（分解条件式）</p>
<div class="highlight"><pre><span class="err">将复杂的条件式提炼为独立函数。</span>
</pre></div>


<p>Consolidate Conditional Expression（合并条件式）</p>
<div class="highlight"><pre><span class="err">将多个条件式判断提炼成一个独立函数。这和上面的分解条件式都需要一个前提：</span> <span class="err">这几个条件式是要有逻辑关联的。</span>
</pre></div>


<p>Consolidate Duplicate Conditional Fragments（合并重复的条件判断）</p>
<div class="highlight"><pre><span class="err">将所有分支里面都拥有的代码提炼到分支判断之后运行。</span>
</pre></div>


<p>Remove Control Flag（移除控制标志）</p>
<div class="highlight"><pre><span class="err">使用</span> <span class="k">break</span><span class="o">/</span><span class="k">return</span> <span class="err">取代控制标记。单一出口，多出口。控制标记让程序接口看上去混乱。</span>
</pre></div>


<p>Replace Nested Conditional with Guard Clauses（以卫语句取代嵌套条件式）</p>
<div class="highlight"><pre><span class="err">保留正常情况下面下的顺序执行，提前对非正常情况进行单独检查并返回。</span> <span class="err">（我更倾向于使用</span><span class="n">Exception</span><span class="err">）</span>
</pre></div>


<p>Replace Conditional with Polymorphism（以多态取代条件式）</p>
<div class="highlight"><pre><span class="err">将条件式的每个分支放入一个</span><span class="n">subclass</span><span class="err">内覆写函数中，然后将原始函数生命为抽象函数。</span> <span class="err">（这个方法之前的</span><span class="mi">5</span><span class="err">种重构手段是代码小手段，引入多态才能充分发挥</span><span class="n">OOP</span><span class="err">优势）</span>
</pre></div>


<p>Introduce Null Object（引入Null对象）</p>
<div class="highlight"><pre><span class="err">将无效值替换为</span><span class="n">null</span> <span class="n">object</span><span class="err">，从而可以让程序正常运行。</span> <span class="err">（这好象是一种</span><span class="n">hack</span><span class="err">方法，我倾向使用</span><span class="n">Exception</span><span class="err">，作者的用以可能是通过</span><span class="n">Null</span><span class="err">来减少判断代码）</span>
</pre></div>


<p>Introduce Assertion（引入断言）</p>
<div class="highlight"><pre><span class="err">通过断言来发现程序错误，实际使用中，可以配合</span> <span class="n">debug</span> <span class="n">mode</span> <span class="err">使用。</span>
</pre></div>


<h3>2.5. 简化函数调用</h3>
<p>Rename Method（重命名函数）</p>
<div class="highlight"><pre><span class="n">A</span> <span class="n">good</span> <span class="n">name</span> <span class="n">is</span> <span class="n">better</span> <span class="n">than</span> <span class="n">a</span> <span class="n">line</span> <span class="n">of</span> <span class="n">comment</span><span class="p">.</span>
</pre></div>


<p>Add Parameter（添加参数）</p>
<div class="highlight"><pre><span class="err">你没看错，就是添加参数。</span> <span class="err">（啊？</span><span class="n">Matin</span><span class="err">老师，不带这么水的阿）</span>
</pre></div>


<p>Remove Parameter（移除参数）</p>
<div class="highlight"><pre><span class="err">不要就丢掉。</span>
</pre></div>


<p>Separate Query from Modifier（将查询参数和修改参数分离）</p>
<div class="highlight"><pre><span class="err">将一个即查询状态又修改状态的函数分离开来，职责分离清楚。</span> <span class="err">（我以前很喜欢写多面手函数～）</span>
</pre></div>


<p>Parameterize Method（令函数携带参数）</p>
<div class="highlight"><pre><span class="err">同一逻辑功能函数，通过重载接受不同参数。而不要建立多个同样的函数。</span>
</pre></div>


<p>Replace Parameter with Explicit Methods（以明确函数取代参数）</p>
<div class="highlight"><pre><span class="err">将单一函数分解为多个函数从而去掉参数，前提是这几个函数的逻辑功能区别较大。</span>
</pre></div>


<p>Preserve Whole Object（保持对象完整）</p>
<div class="highlight"><pre><span class="err">传递完整的对象，取代几个参数的传递。</span>
</pre></div>


<p>Replace Parameter with Methods（以函数取代参数）</p>
<div class="highlight"><pre><span class="err">如果目标函数需要的是几个参数操作的结果，就直接传递这个结果，而不是数个参数。</span>
</pre></div>


<p>Introduce Parameter Object(引入参数对象)</p>
<div class="highlight"><pre><span class="err">当几个参数经常同时出现，就封装他们。</span> <span class="err">（他们之间往往就有逻辑关系）</span>
</pre></div>


<p>Remove Setting Method（移除设值函数）</p>
<div class="highlight"><pre><span class="err">如果类的某个值域初始化后不再改变，就去掉它的</span><span class="n">setting</span><span class="err">方法。</span> <span class="err">（我理解为原则：</span><span class="s">&quot;减少疑惑，保持唯一&quot;</span><span class="err">）</span>
</pre></div>


<p>Hide Method（隐藏某个函数）</p>
<div class="highlight"><pre><span class="err">使用</span> <span class="n">private</span> <span class="err">标记未被其他类调用的方法。</span>
</pre></div>


<p>Replace Constructor with Factory Method（以工厂函数取代构造函数）</p>
<div class="highlight"><pre><span class="err">引入工厂模式。</span>
</pre></div>


<p>Encapsulate Downcast（封装向下转型动作）</p>
<div class="highlight"><pre><span class="err">当知道什么类型时候，将其封装在产生函数里面，减少引用者的困扰。</span>
</pre></div>


<p>Replace Error Code with Exception（以异常取代错误码）</p>
<div class="highlight"><pre><span class="err">如其名。</span> <span class="err">（关于异常使用的时机，抛出的方式，捕捉的粒度，我困惑了很久。</span> <span class="err">最后的总结的经验是：在什么层级处理并且仅处理该层级的异常。等有时间详细成文送出）</span>
</pre></div>


<p>Replace Exception with Test（以测试取代异常）</p>
<div class="highlight"><pre><span class="err">异常不是条件判断。</span>
</pre></div>


<h3>2.6. 处理概括关系</h3>
<p>关于 OOP 继承的那些事儿。</p>
<p>Pull Up Field（值域上移）</p>
<div class="highlight"><pre><span class="err">子类重复的值域放到父类去。</span> <span class="err">（其实还是基于责任归属的问题）</span>
</pre></div>


<p>Pull Up Method（函数上移）</p>
<div class="highlight"><pre><span class="err">子类中重复函数移到父类。</span>
</pre></div>


<p>Pull Up Construction Body（构造函数本体上移）</p>
<div class="highlight"><pre><span class="err">共用的构造函数片段上移。</span>
</pre></div>


<p>Push Down Method（函数下移）</p>
<div class="highlight"><pre><span class="err">将父类中近被某个子类调用的函数下移。</span>
</pre></div>


<p>Push Down Field（值域下移）</p>
<div class="highlight"><pre><span class="err">同上。</span>
</pre></div>


<p>Extract Subclass（提炼子类）</p>
<div class="highlight"><pre><span class="err">当某个类只有部分特性被用到，就需要提取出子类。</span>
</pre></div>


<p>Extract Superclass（提炼超类）</p>
<div class="highlight"><pre><span class="err">和上面相反。</span>
</pre></div>


<p>Extract Interface（提炼接口）</p>
<div class="highlight"><pre><span class="err">将相同的子集提取接口。</span>
</pre></div>


<p>Collapse hierarchy（折叠继承体系）</p>
<div class="highlight"><pre><span class="err">父类和子类并无太大区别时候，合体吧亲。</span>
</pre></div>


<p>From Template Mehod（塑造模板函数）</p>
<div class="highlight"><pre><span class="err">将子类的同功能不同实现函数上移到父类，并在子类提供同名不同实现被调用的子函数。</span>
</pre></div>


<p>Replace Inheritance with Delegation（以委托取代继承）</p>
<div class="highlight"><pre><span class="err">将父类变成一个值域，在调用这个值域的方法。</span><span class="n">is</span><span class="o">-</span><span class="n">a</span> <span class="o">-&gt;</span> <span class="n">has</span><span class="o">-</span><span class="n">a</span> <span class="err">（继承太多就会出问题）</span>
</pre></div>


<p>Replace Delegation with Inheritance（以继承取代委托）</p>
<div class="highlight"><pre><span class="err">和上面相反的应用，当子类和父类出现明显的继承关系时候使用。</span>
</pre></div>


<h3>2.7. 大型重构</h3>
<p>这一章讲的内容有点高屋建瓴，这里就不概括了，建议读原文。</p>
<ul>
<li>Tease Apart Inheritance（梳理并分解继承体系）</li>
<li>Convert Procedural Design to Objects（将过程化设计转化为对象设计）</li>
<li>Separate Domain from Presentation（将领域和表述/显示分离）</li>
<li>Extract hierarchy（提炼继承体系）</li>
</ul>
<p>少年，coding时候重构你的代码吧！</p>
            </div>
            <!-- /.entry-content -->
    <hr />
    <section class="comments" id="comments">
        <h2>Comments</h2>
        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'log4d'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
        </script>
		<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
		<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    

    </section>
        </article>
    </section>

        </div>
        <div class="col-lg-3 well well-sm" id="sidebar">
<aside>
    <section>
        <ul class="list-group list-group-flush">
                <li class="list-group-item"><h4><i class="icon-home icon-large"></i>Social</h4></li>
                    <li class="list-group-item"><a href="http://twitter.com/alswl"><i
                            class="icon-twitter-sign icon-large"></i>twitter
                    </a></li>
                    <li class="list-group-item"><a href="https://github.com/alswl"><i
                            class="icon-github-sign icon-large"></i>github
                    </a></li>
                    <li class="list-group-item"><a href="http://weibo.com/alswlx"><i
                            class="icon-weibo-sign icon-large"></i>weibo
                    </a></li>


                <li class="list-group-item"><h4><i class="icon-home icon-large"></i>Categories</h4></li>
                    <li class="list-group-item">
                        <a href="/category/c/">
                            <i class="icon-folder-open icon-large"></i>C
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="/category/cheng-xu-ren-sheng/">
                            <i class="icon-folder-open icon-large"></i>程序人生
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="/category/delphibian-cheng/">
                            <i class="icon-folder-open icon-large"></i>Delphi编程
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="/category/dotnet/">
                            <i class="icon-folder-open icon-large"></i>dotNet
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="/category/flashbian-cheng/">
                            <i class="icon-folder-open icon-large"></i>Flash编程
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="/category/gan-wu/">
                            <i class="icon-folder-open icon-large"></i>感悟
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="/category/gong-yu-shan-qi-shi-bi-xian-li-qi-qi/">
                            <i class="icon-folder-open icon-large"></i>工欲善其事必先利其器
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="/category/guan-zhu-hu-lian-wang/">
                            <i class="icon-folder-open icon-large"></i>关注互联网
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="/category/javabian-cheng-he-javaqi-ye-ying-yong/">
                            <i class="icon-folder-open icon-large"></i>Java编程和Java企业应用
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="/category/ji-zhu-da-ren/">
                            <i class="icon-folder-open icon-large"></i>技术达人
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="/category/jian-zhan/">
                            <i class="icon-folder-open icon-large"></i>建站
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="/category/jian-zhan-xin-de/">
                            <i class="icon-folder-open icon-large"></i>建站心得
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="/category/linuxer/">
                            <i class="icon-folder-open icon-large"></i>Linuxer
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="/category/mei-shi-peng-ren/">
                            <i class="icon-folder-open icon-large"></i>美食|烹饪
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="/category/microsoft-net/">
                            <i class="icon-folder-open icon-large"></i>Microsoft .Net
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="/category/net-zong-he-ji-zhu/">
                            <i class="icon-folder-open icon-large"></i>.Net, 综合技术
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="/category/phpbian-cheng/">
                            <i class="icon-folder-open icon-large"></i>PHP编程
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="/category/pythonbian-cheng/">
                            <i class="icon-folder-open icon-large"></i>Python编程
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="/category/qian-duan/">
                            <i class="icon-folder-open icon-large"></i>前端
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="/category/qing-chun-de-cai-hong/">
                            <i class="icon-folder-open icon-large"></i>青春的彩虹
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="/category/ri-ji/">
                            <i class="icon-folder-open icon-large"></i>日记
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="/category/ruan-jian-kai-fa-he-xiang-mu-guan-li/">
                            <i class="icon-folder-open icon-large"></i>软件开发和项目管理
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="/category/ruby-bian-cheng/">
                            <i class="icon-folder-open icon-large"></i>Ruby 编程
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="/category/shi-jue-she-ji/">
                            <i class="icon-folder-open icon-large"></i>视觉设计
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="/category/sui-sui-nian/">
                            <i class="icon-folder-open icon-large"></i>碎碎念
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="/category/webqian-duan/">
                            <i class="icon-folder-open icon-large"></i>Web前端
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="/category/wu-hua-ba-men/">
                            <i class="icon-folder-open icon-large"></i>五花八门
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="/category/xue-hai-wu-ya/">
                            <i class="icon-folder-open icon-large"></i>学海无涯
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="/category/yi-dong-shou-chi/">
                            <i class="icon-folder-open icon-large"></i>移动手持
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="/category/yu-le/">
                            <i class="icon-folder-open icon-large"></i>娱乐
                        </a>
                    </li>
                    <li class="list-group-item">
                        <a href="/category/zong-he-ji-zhu/">
                            <i class="icon-folder-open icon-large"></i>综合技术
                        </a>
                    </li>

        </ul>
    </section>
</aside>        </div>
    </div>
</div>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="/theme/js/respond.min.js"></script>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'log4d'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
</body>
</html>