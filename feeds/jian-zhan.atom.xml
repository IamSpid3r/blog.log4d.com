<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Log4D</title><link href="/" rel="alternate"></link><link href="/feeds/jian-zhan.atom.xml" rel="self"></link><id>/</id><updated>2012-05-21T15:17:00+08:00</updated><entry><title>给 Octopress 加上标签功能</title><link href="/2012/05/tag-cloud/" rel="alternate"></link><updated>2012-05-21T15:17:00+08:00</updated><author><name>alswl</name></author><id>tag:,2012-05-21:2012/05/tag-cloud/</id><summary type="html">&lt;p&gt;上周，我将 Log4D 由 Wordpress 转换为 Octopress，略加打理，颇为顺手。
自动分类 / 评论转移 / 代码高亮 / 图床 的问题一一解决之后，
就只剩下 tag 的问题没有搞定了。&lt;/p&gt;
&lt;p&gt;我当时使用了YORKXIN的&lt;a href="https://gist.github.com/1394128"&gt;修改版本&lt;/a&gt;来处理 Wordpress
的数据迁移，这个脚本很好用，数据没有遗失，甚至是让我担心的 category /
tag 都给予了保留。具体使用方法可以参见&lt;a href="http://blog.dayanjia.com/2012/04/migration-to-octopress-from-wordpress/"&gt;从Wordpress迁移到Octopress&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;只是虽然 tag 的数据保留了，但是 &lt;strong&gt;Octopress 仅支持 category 的分类，而完全忽略
tag&lt;/strong&gt;。这是我不能容忍的：category 和 tag 分别代表 有序 / 无序 的知识点归纳方法。
&lt;strong&gt;一篇文章只能属于一个 category，但可以同时属于多个 tag&lt;/strong&gt;。
Octopress 的设计方法显然和我长期养成的知识归纳体系冲突，我开始吭次吭次寻找插件。&lt;/p&gt;


&lt;p&gt;ps：Octopress 官方也推荐了一个所谓「&lt;a href="https://github.com/tokkonopapa/octopress-tagcloud"&gt;octopress-tagcloud&lt;/a&gt;」的插件，
&lt;strong&gt;但这仅仅是让 category 用 列表 / 标签云的形式展示出来，并没有给文章加入 tag
概念&lt;/strong&gt;。更多官方插件可以查看
&lt;a href="https://github.com/imathis/octopress/wiki/3rd-party-plugins"&gt;3rd party plugins&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;就在我准备放弃，自己动手用蹩脚的 ruby 水平写插件时候，突然在 github 找到这种插件：
&lt;a href="https://github.com/robbyedwards/octopress-tag-pages"&gt;robbyedwards / octopress-tag-pages&lt;/a&gt;和 
&lt;a href="https://github.com/robbyedwards/octopress-tag-cloud"&gt;robbyedwards / octopress-tag-cloud&lt;/a&gt;。前者负责采集文章的 tag 信息，后者提供标签云展示功能。赞美 Github。&lt;/p&gt;
&lt;p&gt;这两个插件使用很简单，将插件文件放入对应的目录（&lt;strong&gt;注意备份，存在覆盖的情况&lt;/strong&gt;）。
然后再给插件「octopress-tag-cloud」添加一个专属页面存放标签云即可。
这个标签云生成的标记是 &lt;code&gt;li...li&lt;/code&gt; ，需要在 &lt;code&gt;sass/custom/_styles.scss&lt;/code&gt; 添加对应的样式：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span class="nf"&gt;#content&lt;/span&gt; &lt;span class="nt"&gt;article&lt;/span&gt; &lt;span class="nc"&gt;.cloud&lt;/span&gt; &lt;span class="nt"&gt;li&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;display&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;inline&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;list-style&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="k"&gt;none&lt;/span&gt; &lt;span class="k"&gt;outside&lt;/span&gt; &lt;span class="k"&gt;none&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;padding&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt; &lt;span class="m"&gt;4px&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;第二个插件 octopress-tag-cloud 会和 Octopress 官方推荐的所谓「Octopress Tag Cloud」
 文件 / tag 标记 冲突，我建议修改官方的那个插件。&lt;/p&gt;
&lt;p&gt;我修改过的 octopress-tagcloud 在这里，被重命名为
&lt;a href="https://github.com/alswl/octopress-category-list"&gt;alswl / octopress-category-list&lt;/a&gt;。&lt;/p&gt;
&lt;p&gt;这个版本同时参考了 &lt;a href="http://pfmiles.github.com/blog/liquid-error-about-regexp-match-when-using-octopress-tagcloud/"&gt;pf_miles&lt;/a&gt; 的 utf-8 修改，以修复问题 &lt;code&gt;Liquid error: incompatible encoding regexp match (ASCII-8BIT regexp with UTF-8 string)&lt;/code&gt; 。&lt;/p&gt;
&lt;p&gt;最后 Show 一下我的&lt;a href="http://log4d.com/tag/"&gt;一坨标签云&lt;/a&gt;，
等有时间我再将标签和类别精简一下，以适应 Octopress。&lt;/p&gt;</summary><category term="Octopress"></category></entry><entry><title>使用独立图床子域名</title><link href="/2012/05/image-host/" rel="alternate"></link><updated>2012-05-09T16:21:00+08:00</updated><author><name>alswl</name></author><id>tag:,2012-05-09:2012/05/image-host/</id><summary type="html">&lt;p&gt;最近在将 Wordpres 切换到 OctoPress，顺便将图片统一放到&lt;a href="http://upload-log4d.qiniudn.com"&gt;Upload4D&lt;/a&gt;管理。&lt;/p&gt;
&lt;p&gt;我挑选图床管理程序有下面几个需求，需求由强到弱排列：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;开源&lt;/li&gt;
&lt;li&gt;简单&lt;/li&gt;
&lt;li&gt;不需数据库支持&lt;/li&gt;
&lt;li&gt;支持分目录&lt;/li&gt;
&lt;li&gt;允许上传图片&lt;/li&gt;
&lt;li&gt;支持后台直接操作文件&lt;/li&gt;
&lt;li&gt;支持用户管理，不允许其他人上传&lt;/li&gt;
&lt;li&gt;页面美观&lt;/li&gt;
&lt;li&gt;不要生成缩略图等文件&lt;/li&gt;
&lt;li&gt;软件持续更新&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;于是我踏上了「考古之旅」，先后试用了 MiniGal Nano / MG2 /
CF Image Host Script / minishowcase 等等图床软件，评测记录如下。&lt;/p&gt;


&lt;h2&gt;参赛选手&lt;/h2&gt;
&lt;h3&gt;&lt;a href="http://www.minigal.dk/minigal-nano.html"&gt;MiniGal Nano&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;img alt="MG Nano" src="http://upload-log4d.qiniudn.com/2012/05/mg-nano.png" title="MiniGal Nano" /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;没有上传功能&lt;/li&gt;
&lt;li&gt;没有后台管理功能&lt;/li&gt;
&lt;li&gt;2010年最后更新&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;&lt;a href="http://www.minigal.dk/mg2.html"&gt;MG2&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;img alt="MG2 前台" src="http://upload-log4d.qiniudn.com/2012/05/mg2-front.png" /&gt;
&lt;img alt="MG2 管理界面" src="http://upload-log4d.qiniudn.com/2012/05/mg2-admin.png" /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;假目录，其实所有照片在同一目录下面&lt;/li&gt;
&lt;li&gt;界面丑&lt;/li&gt;
&lt;li&gt;09年更新&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;&lt;a href="http://meiu.cn/"&gt;美优网 Meiu Studio|php相册系统&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;国产&lt;/li&gt;
&lt;li&gt;需要 MySQL&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;&lt;a href="http://www.codefuture.co.uk/projects/imagehost/"&gt;CF Image Hosting Script v1.4.2&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;img alt="CF Image Hosting" src="http://upload-log4d.qiniudn.com/2012/05/cf-image-host.png" /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;据说煎蛋在使用&lt;/li&gt;
&lt;li&gt;无法用户控制&lt;/li&gt;
&lt;li&gt;无目录&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;&lt;a href="http://minishowcase.net/"&gt;Minishowcase&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;没看见上传功能&lt;/li&gt;
&lt;li&gt;没看见目录功能&lt;/li&gt;
&lt;li&gt;丑&lt;/li&gt;
&lt;li&gt;2009年更新&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;&lt;a href="http://qdig.sourceforge.net/"&gt;Qdig&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;img alt="Qdig" src="http://upload-log4d.qiniudn.com/2012/05/qdig.png" /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;无法上传&lt;/li&gt;
&lt;li&gt;丑&lt;/li&gt;
&lt;li&gt;2006年更新&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;&lt;a href="http://sourceforge.net/projects/ifoto/"&gt;iFoto, CSS-based GD2 photo gallery&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;img alt="iFoto" src="http://upload-log4d.qiniudn.com/2012/05/ifoto.png" /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;无法上传&lt;/li&gt;
&lt;li&gt;丑&lt;/li&gt;
&lt;li&gt;2006年更新&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;&lt;a href="http://encode-explorer.siineiolekala.net/"&gt;Encode Explorer&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;img alt="Encode Explorer" src="http://upload-log4d.qiniudn.com/2012/05/encode-explorer.png" /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;这其实是一个文件管理器&lt;/li&gt;
&lt;li&gt;支持预览&lt;/li&gt;
&lt;li&gt;不支持多文件上传&lt;/li&gt;
&lt;li&gt;其他要求全部达到&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;最终选择&lt;/h2&gt;
&lt;p&gt;最后，我选择了 Encode Explorer，坑爹吧，获胜者居然是一个文件管理软件，
而不是一个图床软件。&lt;/p&gt;
&lt;p&gt;Encode Explorer 是单文件程序，代码一共3k多行，我看了一下，还能支持多语言，
我就加上了中文支持，并且修正了新建目录/新建文件的权限 bug，改为目录755,
文件644，并且这两个模式可以在配置文件修改。&lt;/p&gt;
&lt;p&gt;修改之后的 Encode Explorer 可以在
&lt;a href="https://github.com/alswl/encode-explorer"&gt;alswl / encode-explorer&lt;/a&gt; 找到。&lt;/p&gt;
&lt;p&gt;既然已经不单纯是图床了，那我也把以前的一些附件放到这个子域名下，域名也要由
img.log4d.com 改为 upload.log4d.com 。&lt;/p&gt;
&lt;p&gt;我用 sed 命令将原来的图片和附件命令批量修改，命令如下
&lt;code&gt;sed -i 's/log4d.com\/wp-content\/uploads/upload.log4d.com/g' ./_posts/*&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;ps:今天是我博客独立3周年纪念日，本来想在今天之前把 Wordpress 迁移到
OctoPress，可惜最近太忙，就耽误了。&lt;/p&gt;</summary><category term="minigal nano"></category><category term="CF Image Host Script"></category></entry></feed>